{% schema %}
{
  "name": "Referral Tracker",
  "target": "body",
  "javascript": "referral-tracker.js",
  "settings": [
     { "type": "color", "id": "modal_bg", "label": "Modal Background", "default": "#ffffff" },
     { "type": "color", "id": "btn_color", "label": "Button Color", "default": "#000000" }
  ]
}
{% endschema %}

<!-- Invisible Div to pass Liquid data to JS -->
<div id="referet-global-tracker" 
     data-shop="{{ shop.permanent_domain }}" 
     data-customer-id="{{ customer.id }}"
     data-logged-in="{% if customer %}true{% else %}false{% endif %}">
</div>

<!-- Guest Modal (Hidden by Default) -->
{% unless customer %}
<div id="referet-guest-modal" style="display:none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
    <div style="background-color: {{ block.settings.modal_bg }}; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 400px; border-radius: 8px; position: relative; text-align: center;">
       <span id="referet-guest-close" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
       <h2>You've been referred!</h2>
       <p style="margin: 20px 0;">Login to claim your referral reward.</p>
       <a href="/account/login" style="background-color: {{ block.settings.btn_color }}; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; display: inline-block;">Login Now</a>
    </div>
</div>
{% endunless %}
